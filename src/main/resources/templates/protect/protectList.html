<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">
<th:block layout:fragment="script">
  <script th:inline="javascript">
    $(() => {
      $('#searchBtn').on("click",(e) => {
        e.preventDefault();
        page(0)
      });
    });
    function page(page){
      const searchBy = $("#searchBy").val();
      const searchQuery = $("#searchQuery").val();

      location.href="/dadog/protect/list/" + page + "?searchBy=" + searchBy + "&searchQuery=" + searchQuery;
    }
    function addProtect(){
      location.href="/dadog/protect/add";
    }
  </script>
</th:block>

<th:block layout:fragment="css">
  <style>
    h1{
      text-align: center;
    }
    ul{
      text-decoration-line: none;
    }
    .mainBody {
      width: 80%;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 300px));
      margin: 0 auto;
      gap: 16px; /* 아이템 간의 간격을 설정할 수 있습니다. */
    }
    .card{
      margin: 10px;
    }

  </style>
</th:block>
<div layout:fragment="mainContent">
  <form th:action="@{'/dadog/protect' + ${protectList.number}}" role="form" method="get" th:object="${protectList}">
    <article class="mainBody">
      <div th:each="protect : ${protectList.getContent()}" class="card">
        <a th:href="'/dadog/protect/' + ${protect.getProNo()}" class="text-dark link-underline link-underline-opacity-0">
          <img th:src="${protect.getProImgUrl()}" th:alt="사진" class="card-img-top" width="300" height="300"/>
          <div class="card-body">
            <h5 class="card-title" th:text="${protect.getProTitle()}"></h5>
            <p th:text="${protect.getProKind()}" class="card-text"></p>
            <p th:text="${protect.getProPlace()}" class="card-text"></p>
            <p th:text="${protect.getProTel()}" class="card-text"></p>
            <p th:text="${protect.getProDate()}" class="card-text"></p>
          </div>
        </a>
      </div>
    </article>
    <div th:with="start=${(protectList.number / maxPage) * maxPage + 1},
            end=${(protectList.totalPages == 0 ? 1 :
            (start + (maxPage - 1) < protectList.totalPages ? start + (maxPage - 1):
            protectList.totalPages))}">
      <ul class="pagination justify-content-center">
        <li class="page-item" th:classappend="${protectList.first} ? 'disabled'">
          <a th:onclick="'javascript: page(' + ${protectList.number -1} + ')'" aria-label="Previous" class="page-link">
            <span aria-hidden="true">Previous</span>
          </a>
        </li>
        <li class="page-item" th:each="page: ${#numbers.sequence(start,end)}"
            th:classappend="${protectList.number eq page -1}? 'active' : ''">
          <a th:onclick="'javascript: page(' +${page -1} + ')'" th:inline="text" class="page-link">[[${page}]]
          </a>
        </li>
        <li class="page-item" th:classappend="${protectList.last} ? 'disabled'">
          <a th:onclick="'javascript: page(' + ${protectList.number +1} + ')'" aria-label="Next" class="page-link">
            <span aria-hidden="true">Next</span>
          </a>
        </li>
      </ul>
    </div>
    <div class="form-inline justify-content-center" th:object="${protectSearchDTO}">
      <select th:field="*{searchBy}" class="form-control" id="searchBy" style="width: auto;">
        <option value="kind">견종</option>
        <option value="title">제목</option>
        <option value="detail">글 내용</option>
        <option value="place">실종장소</option>
      </select>
      <input th:field="*{searchQuery}" class="form-control" id="searchQuery" placeholder="검색어">
      <button id="searchBtn" type="submit" class="btn btn-primary">검색</button>
      <button class="btn btn-outline-dark" type="button" onclick="addProtect()">
        글쓰기
      </button>
    </div>
  </form>
</div>
</html>